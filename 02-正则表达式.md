# 正则表达式

## 匹配单个字符

### 基本用法

| 含义                       | 写法                      |
| -------------------------- | ------------------------- |
| 纯文本                     | w                         |
| 任意字符                   | .                         |
| 特殊字符                   | \\\\                      |
| 集合中的一个字符           | \[abc] 、 \[A-Za-z0-9]    |
| 不包含 集合中 任意一个字符 | [^abc]      |
| 空白符                     | [\\b]、\f \\n \\r \\t \\r |

> Python中，'.' 不能匹配'\n' 。加入re.S后可以

> 集合中 也能放入\s \w这样的 单个元字符
>
> [s]常常放入一个元素 与 ? 等重复匹配结合，增强可读性

### 元字符

#### 空白字符类

| 含义                    | 写法      |
| ----------------------- | --------- |
| Backspace键，回退并删除 | [\b]      |
| 换页符                  | \f        |
| 换行符                  | \n        |
| 回车符                  | \r        |
| 水平制表符              | \t        |
| 垂直制表符              | \v        |
| 任意一个空白字符        | \s        |
| 任意一个非空白字符      | \S        |
| 空格or水平制表符        | [:blank:] |
| 空白字符+空格           | [:space:] |

>\r\n 匹配一个“回车+换行”组合，Windows的换行标识
>
>\n Linux

#### 数字、字母类

| 含义                     | 写法       |
| ------------------------ | ---------- |
| 任意一个数字字符[0-9]    | \d         |
| 任意一个非数字字符       | \D         |
| 任意一个字母数字或下划线 | \w         |
| 上一行取反               | \W         |
| 匹配十六进制             | \x前缀     |
| 任何十六进制[a-fA-F0-9]  | [:xdigit:] |
| 匹配八进制               | \0前缀     |
| 字母或数字               | [:alnum:]  |
| 字母                     | [:alpha:]  |
| 数字                     | [:digit:]  |
| 小写字母                 | [:lower:]  |
| 大写字母                 | [:upper:]  |

#### 其他

| 含义                              | 写法      |
| --------------------------------- | --------- |
| ASCII 控制字符                    | [:cntrl:] |
| 可打印字符                        | [:print:] |
| 可打印字符（空格除外）            | [:graph:] |
| [:alnum:] 和 [:cntrl:] 之外的字符 | [:punct:] |

## 重复匹配问题

### 基本用法

| 重复次数     | 写法  |
| ------------ | ----- |
| ≥ 1 (贪婪)   | +     |
| ≥ 1 (懒惰)   | +?    |
| ≥ 0 (贪婪)   | *     |
| ≥ 0 (懒惰)   | *?    |
| 0 或 1       | ?     |
| n            | {n}   |
| m ≤ 次数 ≤ n | {m,n} |
| ≥ n (贪婪)   | {n,}  |
| ≥ n (懒惰)   | {n,}? |

### 作用范围

+ 紧挨着它的前一个 字符 / 元字符 / 子表达式

### 贪婪问题

#### 匹配行为

+ 贪婪匹配：尽可能地从一段文本的开头一直匹配到这段文本的末尾
+ 懒惰匹配：从这段文本的开头匹配到碰到第一个匹配时为止

```html
<B>AK</B> and <B>HI</B>
```

```python
<[Bb]>.*?</B>
# 会匹配两个B标签
```

```python
<[Bb]>.*</B>
# 所有内容都匹配到
```

#### 注意事项

+ 需要防止过度匹配的场合下，请使用“懒惰型”
+ 区分 重复匹配是针对单个字符或一个字符集合，并不是 匹配的结果是否重复

## 位置匹配

### 单词边界\b

+ \b 匹配一个单词的开始或结尾

```python
\bcat\b  # 匹配完整单词
\bcat # 匹配以cat开头的单词
cat\b # 匹配以cat结尾的单词
```

### 字符串边界^$

^  匹配一个字符串的开头位置

$  匹配一个字符串的结束位置（换行结束位置）

> 分行匹配模式(?m)
>
> 把行分隔符 当做 一个字符串的 分隔符 对待



## 子表达式

### 简单应用

更大的表达式的一部分，当做一个 独立元素 来使用，需要用(和) 括起来；

可以用于整体 重复匹配问题

```python
(&nbsp;){2,}
```

也可以划分作用范围

```python
19|20\d{2}
```

```python
(19|20)\d{2}
```

> 每个子表达式 都 加上 括号 会对匹配速度造成一定影响

### 不同表达式之间的连接方式

+ 对表达式的理解：
  + 单个元素，单个元字符为 独立的组成部分
  + 通过()可以组合成一个整体
  + “整体”基础上，加上重复匹配等修饰，构成表达式

+ 连接方式
  + 不加任何修饰
  + 或运算符 | ，两个表达式之间 2选1

### 子表达式的嵌套

上述讨论的表达式可以继续 利用 或运算符，重复匹配等结合，形成新的表达式，进而形成一层层的嵌套。

理论上没有限制，但应该遵循适可而止的原则

## 全局性的设置

### 匹配结果的问题g

+ 大部分 默认 返回第1个匹配结果
+ 可以把 所有的匹配结果 全部找出来，返回一个数组或者 其他的专用格式

### 大小写问题

JavaScript可以用 i 标志 强制执行一次 不区分字母大小写的搜索

### 分行匹配模式

(?m)必须出现在整个模式的最前面

> 多数正则表达式 不支持